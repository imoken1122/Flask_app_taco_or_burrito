### 4 実験

　本実験では, 研究室で管理しているダークネットで観測した2018 年 1 月 1 日 の UDP パケットのペイロードを用いた. 前処理として, 総パケット数が 1 個のホストは分析対象外とし, 各ホスト毎のユニークなペイロードのみを分析に用いる.

#### 4.1 類似度行列の作成
各ホスト間のペイロードを用いた NLD の算出方法を改めて定式化する. あるホスト$`H_i`$ が送信したユニークなペイロードのリストを, $`H_i = [P^{i}_1, P^{i}_2, ... ,P^{i}_N]`$ と定義し, １パケット分のペイロードは $` P^{i}_k = [p_1,p_2,...,p_L]`$ と定義する. ただし, $`N`$ は各ホストのユニークなペイロードの総数であり, $`L`$ は１パケット分のペイロード長である.  また, 類似度行列の作成にあたって計算量軽減のため, 同一ホストが送信するペイロードは類似していることを仮定し, 比較対象であるホスト共々のユニークなペイロードの総数が D 個以上であれば, D 個のペイロードをランダムサンプリングする. 本実験では $`D=10`$ とした.  NLD の計算は式(3)に示す.


```math
a_{ij} = \frac{1}{NM}\sum_{n}^{N}\sum_{m}^{M} (1 - NLD(P^{i}_n,P^{j}_m)) \tag3

```
$`N,M`$ は, 2つのホストのユニークなペイロードの総数が $`D`$ 以上であれば, $`N=M = D`$ となる. 　　

　各ホスト間のペイロードの類似度を NLD で計算した類似度行列図１に示す. 類似度が高いほど白色であり, 低いほど黒色である.

#### 4.2 実験結果

 4.1節で作成した類似度行列を用いて, スペクトラルクラスタリングを行った結果を示す. 
